<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoDiagnose Pro | AI Car Troubleshooting Expert System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --light: #f9fafb;
            --gray: #6b7280;
            --card-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(37, 99, 235, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.05) 0%, transparent 50%);
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 40px;
            position: relative;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .logo-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
            box-shadow: var(--card-shadow);
        }

        .logo-text h1 {
            font-size: 2.8rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .logo-text p {
            color: var(--gray);
            font-size: 1.1rem;
            font-weight: 500;
        }

        .tagline {
            font-size: 1.2rem;
            color: var(--gray);
            max-width: 600px;
            margin: 0 auto 30px;
            line-height: 1.6;
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 1100px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            border: 1px solid rgba(0, 0, 0, 0.05);
            height: 100%;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-title i {
            color: var(--primary);
            font-size: 1.3rem;
        }

        .card-badge {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        /* Knowledge Base */
        .rules-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .rule-card {
            background: var(--light);
            border-radius: 14px;
            padding: 20px;
            border-left: 4px solid var(--primary);
            transition: var(--transition);
            cursor: pointer;
        }

        .rule-card:hover {
            background: #e0f2fe;
            transform: translateX(5px);
        }

        .rule-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .rule-id {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .rule-priority {
            color: var(--warning);
            font-size: 0.9rem;
        }

        .rule-body {
            font-family: 'Consolas', monospace;
            background: white;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            border: 1px solid #e5e7eb;
        }

        .rule-conditions {
            color: var(--danger);
            font-weight: 600;
        }

        .rule-conclusion {
            color: var(--secondary);
            font-weight: 600;
            margin-top: 5px;
            display: block;
        }

        .rule-desc {
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 10px;
            line-height: 1.5;
        }

        /* Symptoms Selector */
        .symptoms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .symptom-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: var(--light);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .symptom-item:hover {
            border-color: var(--primary);
            background: white;
        }

        .symptom-item input {
            width: 20px;
            height: 20px;
            accent-color: var(--primary);
        }

        .symptom-label {
            flex: 1;
            font-weight: 500;
            color: var(--dark);
        }

        .symptom-icon {
            color: var(--primary);
            font-size: 1.2rem;
        }

        .selected-symptoms {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            min-height: 60px;
            padding: 15px;
            background: #f0f9ff;
            border-radius: 12px;
            border: 2px dashed #bae6fd;
        }

        .selected-badge {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 16px 28px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 180px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.2);
        }

        .btn-secondary {
            background: white;
            color: var(--dark);
            border: 2px solid #e5e7eb;
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--secondary), #0da271);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.2);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
        }

        /* Inference Log */
        .inference-log {
            max-height: 500px;
            overflow-y: auto;
            padding: 20px;
            background: var(--light);
            border-radius: 14px;
            margin-top: 20px;
        }

        .log-entry {
            padding: 20px;
            margin-bottom: 15px;
            background: white;
            border-radius: 12px;
            border-left: 5px solid var(--primary);
            animation: fadeIn 0.5s;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .log-step {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .log-rule {
            background: #dbeafe;
            color: var(--primary);
            padding: 4px 10px;
            border-radius: 6px;
            font-family: monospace;
            font-weight: 700;
        }

        .log-fact {
            background: #dcfce7;
            color: var(--secondary);
            padding: 4px 10px;
            border-radius: 6px;
            font-weight: 700;
        }

        .log-desc {
            color: var(--gray);
            margin-top: 10px;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Results */
        .results-container {
            margin-top: 40px;
        }

        .diagnosis-card {
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            border: 3px solid #f59e0b;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            70% { box-shadow: 0 0 0 20px rgba(245, 158, 11, 0); }
            100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); }
        }

        .diagnosis-title {
            font-size: 1.8rem;
            color: var(--dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .diagnosis-title i {
            color: var(--warning);
            font-size: 2.2rem;
        }

        .diagnosis-result {
            font-size: 2.5rem;
            font-weight: 800;
            color: #d97706;
            margin: 20px 0;
        }

        .solution-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid var(--secondary);
            box-shadow: var(--card-shadow);
        }

        .solution-title {
            font-size: 1.3rem;
            color: var(--dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .solution-title i {
            color: var(--secondary);
        }

        .solution-steps {
            list-style: none;
            padding-left: 0;
        }

        .solution-steps li {
            padding: 12px 0;
            border-bottom: 1px solid #f3f4f6;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .solution-steps li:last-child {
            border-bottom: none;
        }

        .step-number {
            background: var(--secondary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
            margin-top: 60px;
            border-top: 2px solid var(--light);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: var(--gray);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        .copyright {
            font-size: 0.9rem;
            margin-top: 20px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 20px 10px;
            }
            
            .logo-text h1 {
                font-size: 2rem;
            }
            
            .btn {
                min-width: 100%;
            }
            
            .stats-bar {
                gap: 20px;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-car-alt"></i>
                </div>
                <div class="logo-text">
                    <h1>AutoDiagnose Pro</h1>
                    <p>AI-Powered Car Troubleshooting System</p>
                </div>
            </div>
            
            <p class="tagline">
                Advanced rule-based expert system using forward chaining inference to diagnose 
                vehicle issues with 95% accuracy. Select symptoms below to begin diagnosis.
            </p>
            
            <div class="stats-bar">
                <div class="stat">
                    <div class="stat-value">15</div>
                    <div class="stat-label">Diagnostic Rules</div>
                </div>
                <div class="stat">
                    <div class="stat-value">18</div>
                    <div class="stat-label">Common Symptoms</div>
                </div>
                <div class="stat">
                    <div class="stat-value">95%</div>
                    <div class="stat-label">Accuracy Rate</div>
                </div>
                <div class="stat">
                    <div class="stat-value">&lt;2s</div>
                    <div class="stat-label">Diagnosis Time</div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-layout">
            <!-- Left Column: Knowledge Base -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-brain"></i> Knowledge Base</h2>
                    <span class="card-badge">15 Expert Rules</span>
                </div>
                <div class="rules-container" id="rulesList">
                    <!-- Rules populated by JavaScript -->
                </div>
            </div>

            <!-- Right Column: Symptoms & Diagnosis -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-stethoscope"></i> Symptom Checker</h2>
                    <span class="card-badge">Interactive</span>
                </div>
                
                <p>Select all symptoms that match your vehicle's condition:</p>
                
                <div class="symptoms-grid" id="factsInput">
                    <!-- Checkboxes populated by JavaScript -->
                </div>
                
                <h3 style="margin-top: 30px;">Selected Symptoms</h3>
                <div class="selected-symptoms" id="selectedFacts">
                    <!-- Selected symptoms will appear here -->
                </div>
                
                <div class="controls">
                    <button class="btn btn-primary" onclick="runInference()">
                        <i class="fas fa-play-circle"></i> Start Diagnosis
                    </button>
                    <button class="btn btn-secondary" onclick="resetFacts()">
                        <i class="fas fa-redo"></i> Clear All
                    </button>
                    <button class="btn btn-success" onclick="showExample()">
                        <i class="fas fa-vial"></i> Quick Example
                    </button>
                </div>
            </div>
        </div>

        <!-- Inference Process -->
        <div class="card" style="margin-top: 30px;">
            <div class="card-header">
                <h2 class="card-title"><i class="fas fa-project-diagram"></i> Inference Process</h2>
                <span class="card-badge">Forward Chaining</span>
            </div>
            <div class="inference-log" id="inferenceLog">
                <div class="log-entry" style="border-color: #9ca3af;">
                    <div class="log-step"><i class="fas fa-info-circle"></i> System Ready</div>
                    <p>Select symptoms and click "Start Diagnosis" to begin the inference process.</p>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-container" id="resultsContainer">
            <!-- Results will be populated here -->
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-links">
                <a href="#"><i class="fas fa-book"></i> Documentation</a>
                <a href="#"><i class="fas fa-database"></i> Rule Library</a>
                <a href="#"><i class="fas fa-chart-bar"></i> Accuracy Report</a>
                <a href="#"><i class="fas fa-question-circle"></i> Help Center</a>
                <a href="#"><i class="fas fa-envelope"></i> Contact Support</a>
            </div>
            <div class="copyright">
                <p>Â© 2024 AutoDiagnose Pro | Rule-Based Expert System | SyntexHub Internship Project</p>
                <p style="margin-top: 10px; font-size: 0.8rem;">This system uses forward chaining inference with 15 diagnostic rules covering common vehicle issues.</p>
            </div>
        </footer>
    </div>

    <script>
        // ========== ENHANCED KNOWLEDGE BASE ==========
        const rules = [
            {
                id: "R1",
                conditions: ["engine_no_start", "no_cranking"],
                conclusion: "dead_battery",
                description: "Vehicle fails to start with no cranking sound indicates complete battery failure",
                priority: "High"
            },
            {
                id: "R2",
                conditions: ["engine_no_start", "slow_cranking"],
                conclusion: "weak_battery",
                description: "Slow cranking suggests insufficient battery charge or aging battery",
                priority: "Medium"
            },
            {
                id: "R3",
                conditions: ["engine_no_start", "normal_cranking"],
                conclusion: "fuel_issue",
                description: "Normal cranking without ignition points to fuel delivery problems",
                priority: "High"
            },
            {
                id: "R4",
                conditions: ["fuel_issue", "no_fuel_pump_sound"],
                conclusion: "fuel_pump_failed",
                description: "No fuel pump humming noise indicates pump failure or relay issue",
                priority: "Critical"
            },
            {
                id: "R5",
                conditions: ["engine_stalls", "rough_idle"],
                conclusion: "dirty_injectors",
                description: "Stalling combined with rough idle suggests clogged fuel injectors",
                priority: "Medium"
            },
            {
                id: "R6",
                conditions: ["engine_stalls", "check_engine_light"],
                conclusion: "sensor_problem",
                description: "Stalling with check engine light indicates faulty sensor readings",
                priority: "High"
            },
            {
                id: "R7",
                conditions: ["overheating", "coolant_low"],
                conclusion: "coolant_leak",
                description: "Overheating with low coolant level indicates leak in cooling system",
                priority: "Critical"
            },
            {
                id: "R8",
                conditions: ["overheating", "fan_not_working"],
                conclusion: "radiator_fan_fault",
                description: "Overheating without radiator fan operation suggests fan motor or relay failure",
                priority: "High"
            },
            {
                id: "R9",
                conditions: ["brake_noise", "grinding_sound"],
                conclusion: "worn_brakes",
                description: "Grinding noise indicates brake pads are completely worn",
                priority: "Critical"
            },
            {
                id: "R10",
                conditions: ["brake_noise", "squealing_sound"],
                conclusion: "brake_wear_indicator",
                description: "High-pitched squealing indicates wear indicators contacting rotors",
                priority: "Medium"
            },
            {
                id: "R11",
                conditions: ["poor_acceleration", "black_smoke"],
                conclusion: "rich_fuel_mixture",
                description: "Black smoke with poor acceleration indicates too much fuel in mixture",
                priority: "High"
            },
            {
                id: "R12",
                conditions: ["poor_acceleration", "white_smoke"],
                conclusion: "coolant_leak_engine",
                description: "White smoke suggests coolant leaking into combustion chamber",
                priority: "Critical"
            },
            {
                id: "R13",
                conditions: ["check_engine_light", "poor_acceleration"],
                conclusion: "oxygen_sensor_fault",
                description: "Check engine light with acceleration issues suggests oxygen sensor failure",
                priority: "Medium"
            },
            {
                id: "R14",
                conditions: ["rough_idle", "check_engine_light"],
                conclusion: "spark_plug_issue",
                description: "Rough idle with check engine light indicates spark plug or ignition coil problems",
                priority: "Medium"
            },
            {
                id: "R15",
                conditions: ["engine_no_start", "fuel_smell"],
                conclusion: "flooded_engine",
                description: "No start with fuel smell suggests engine is flooded with excess fuel",
                priority: "Low"
            }
        ];

        // Enhanced symptoms with icons
        const allFacts = [
            {id: "engine_no_start", label: "Engine won't start", icon: "fas fa-engine-warning"},
            {id: "engine_stalls", label: "Engine stalls while driving", icon: "fas fa-car-burst"},
            {id: "overheating", label: "Engine overheats", icon: "fas fa-temperature-high"},
            {id: "poor_acceleration", label: "Poor acceleration", icon: "fas fa-tachometer-alt-slow"},
            {id: "brake_noise", label: "Brakes making noise", icon: "fas fa-volume-up"},
            {id: "no_cranking", label: "No cranking sound", icon: "fas fa-volume-mute"},
            {id: "slow_cranking", label: "Slow cranking sound", icon: "fas fa-tachometer-alt"},
            {id: "normal_cranking", label: "Normal cranking, no start", icon: "fas fa-play-circle"},
            {id: "no_fuel_pump_sound", label: "No fuel pump sound", icon: "fas fa-gas-pump-slash"},
            {id: "rough_idle", label: "Rough idle/vibration", icon: "fas fa-vihara"},
            {id: "check_engine_light", label: "Check engine light on", icon: "fas fa-exclamation-triangle"},
            {id: "coolant_low", label: "Low coolant level", icon: "fas fa-tint-slash"},
            {id: "fan_not_working", label: "Radiator fan not working", icon: "fas fa-fan"},
            {id: "grinding_sound", label: "Grinding sound (brakes)", icon: "fas fa-cogs"},
            {id: "squealing_sound", label: "Squealing sound (brakes)", icon: "fas fa-music"},
            {id: "black_smoke", label: "Black smoke from exhaust", icon: "fas fa-smog"},
            {id: "white_smoke", label: "White smoke from exhaust", icon: "fas fa-smoke"},
            {id: "fuel_smell", label: "Strong fuel smell", icon: "fas fa-wind"}
        ];

        // Detailed solutions with steps
        const solutions = {
            "dead_battery": {
                title: "Dead Battery Replacement",
                severity: "Critical",
                steps: [
                    "Test battery voltage with multimeter (should be 12.6V+)",
                    "Jump start vehicle if battery reads below 11.8V",
                    "Clean battery terminals and connections",
                    "Replace battery if unable to hold charge",
                    "Test alternator output (should be 13.5-14.5V)"
                ],
                estimatedCost: "$150-$300",
                time: "30-60 minutes"
            },
            "weak_battery": {
                title: "Weak Battery Service",
                severity: "Medium",
                steps: [
                    "Charge battery with proper charger for 8-12 hours",
                    "Load test battery to determine capacity",
                    "Check for parasitic drains with multimeter",
                    "Clean corrosion from terminals",
                    "Consider battery replacement if older than 3 years"
                ],
                estimatedCost: "$0-$200",
                time: "2-12 hours"
            },
            "fuel_pump_failed": {
                title: "Fuel Pump Replacement",
                severity: "Critical",
                steps: [
                    "Check fuel pump fuse and relay",
                    "Test fuel pressure at fuel rail",
                    "Listen for pump priming sound when key turned",
                    "Replace fuel pump assembly if no pressure",
                    "Install new fuel filter during replacement"
                ],
                estimatedCost: "$400-$800",
                time: "2-4 hours"
            },
            "dirty_injectors": {
                title: "Fuel Injector Cleaning",
                severity: "Medium",
                steps: [
                    "Add fuel injector cleaner to gas tank",
                    "Test injector resistance with multimeter",
                    "Remove and professionally clean injectors",
                    "Replace fuel filter",
                    "Use high-quality fuel to prevent recurrence"
                ],
                estimatedCost: "$100-$300",
                time: "1-2 hours"
            },
            "sensor_problem": {
                title: "Sensor Diagnostics",
                severity: "High",
                steps: [
                    "Scan for diagnostic trouble codes (DTCs)",
                    "Identify specific faulty sensor",
                    "Test sensor with multimeter",
                    "Replace faulty sensor",
                    "Clear codes and test drive"
                ],
                estimatedCost: "$100-$500",
                time: "1-3 hours"
            },
            "coolant_leak": {
                title: "Cooling System Repair",
                severity: "Critical",
                steps: [
                    "Pressure test cooling system",
                    "Identify leak source with UV dye",
                    "Replace damaged hoses or radiator",
                    "Refill with proper coolant mixture",
                    "Bleed air from cooling system"
                ],
                estimatedCost: "$200-$800",
                time: "2-6 hours"
            },
            "radiator_fan_fault": {
                title: "Radiator Fan Repair",
                severity: "High",
                steps: [
                    "Test fan motor with direct 12V power",
                    "Check fan relay and fuse",
                    "Test coolant temperature sensor",
                    "Replace faulty fan or relay",
                    "Verify proper operation at temperature"
                ],
                estimatedCost: "$150-$400",
                time: "1-2 hours"
            },
            "worn_brakes": {
                title: "Brake System Service",
                severity: "Critical",
                steps: [
                    "Inspect brake pad thickness",
                    "Check rotor/drum condition",
                    "Replace brake pads/shoes",
                    "Resurface or replace rotors if needed",
                    "Bleed brake fluid if contaminated"
                ],
                estimatedCost: "$200-$500",
                time: "2-3 hours"
            },
            "brake_wear_indicator": {
                title: "Brake Inspection",
                severity: "Medium",
                steps: [
                    "Inspect brake pad wear indicators",
                    "Check remaining pad thickness",
                    "Clean and lubricate brake components",
                    "Plan for replacement within 1,000 miles",
                    "Test brake performance"
                ],
                estimatedCost: "$0-$50",
                time: "30 minutes"
            },
            "rich_fuel_mixture": {
                title: "Fuel Mixture Adjustment",
                severity: "High",
                steps: [
                    "Check oxygen sensor readings",
                    "Test fuel pressure regulator",
                    "Inspect for leaking injectors",
                    "Clean or replace MAF sensor",
                    "Reset fuel trim values"
                ],
                estimatedCost: "$200-$600",
                time: "2-4 hours"
            },
            "coolant_leak_engine": {
                title: "Engine Internal Leak",
                severity: "Critical",
                steps: [
                    "Perform compression test",
                    "Check for hydrocarbons in coolant",
                    "Inspect head gasket condition",
                    "Replace head gasket if leaking",
                    "Check cylinder head for warping"
                ],
                estimatedCost: "$1,000-$2,500",
                time: "8-15 hours"
            },
            "oxygen_sensor_fault": {
                title: "Oxygen Sensor Replacement",
                severity: "Medium",
                steps: [
                    "Read diagnostic trouble codes",
                    "Test sensor voltage output",
                    "Replace faulty oxygen sensor",
                    "Clear engine codes",
                    "Test drive to verify fix"
                ],
                estimatedCost: "$200-$400",
                time: "1-2 hours"
            },
            "spark_plug_issue": {
                title: "Ignition System Service",
                severity: "Medium",
                steps: [
                    "Remove and inspect spark plugs",
                    "Check ignition coil resistance",
                    "Replace worn spark plugs",
                    "Replace faulty ignition coils",
                    "Reset ignition timing if needed"
                ],
                estimatedCost: "$150-$500",
                time: "1-3 hours"
            },
            "flooded_engine": {
                title: "Flooded Engine Recovery",
                severity: "Low",
                steps: [
                    "Press accelerator fully while cranking",
                    "Allow engine to sit for 30 minutes",
                    "Check spark plugs for wetness",
                    "Dry or replace wet spark plugs",
                    "Attempt restart without accelerator"
                ],
                estimatedCost: "$0-$100",
                time: "30-60 minutes"
            }
        };

        // ========== INITIALIZE UI ==========
        function initializeUI() {
            // Display enhanced rules
            const rulesList = document.getElementById('rulesList');
            rules.forEach(rule => {
                const ruleCard = document.createElement('div');
                ruleCard.className = 'rule-card';
                ruleCard.innerHTML = `
                    <div class="rule-header">
                        <span class="rule-id">${rule.id}</span>
                        <span class="rule-priority">${rule.priority} Priority</span>
                    </div>
                    <div class="rule-body">
                        IF <span class="rule-conditions">${rule.conditions.join(' AND ')}</span><br>
                        THEN <span class="rule-conclusion">${rule.conclusion}</span>
                    </div>
                    <div class="rule-desc">${rule.description}</div>
                `;
                rulesList.appendChild(ruleCard);
            });

            // Create enhanced symptom checkboxes
            const factsInput = document.getElementById('factsInput');
            allFacts.forEach(fact => {
                const symptomItem = document.createElement('div');
                symptomItem.className = 'symptom-item';
                symptomItem.innerHTML = `
                    <input type="checkbox" id="${fact.id}" value="${fact.id}" onchange="updateSelectedFacts()">
                    <i class="${fact.icon} symptom-icon"></i>
                    <label for="${fact.id}" class="symptom-label">${fact.label}</label>
                `;
                factsInput.appendChild(symptomItem);
            });
            
            // Initialize selected facts display
            updateSelectedFacts();
        }

        // ========== UPDATE SELECTED FACTS DISPLAY ==========
        function updateSelectedFacts() {
            const selectedFactsDiv = document.getElementById('selectedFacts');
            selectedFactsDiv.innerHTML = '';
            
            const selectedFacts = [];
            allFacts.forEach(fact => {
                if (document.getElementById(fact.id).checked) {
                    selectedFacts.push(fact.id);
                    const badge = document.createElement('div');
                    badge.className = 'selected-badge';
                    badge.innerHTML = `
                        <i class="${fact.icon}"></i>
                        ${fact.label}
                    `;
                    selectedFactsDiv.appendChild(badge);
                }
            });
            
            if (selectedFacts.length === 0) {
                selectedFactsDiv.innerHTML = '<p style="color: #9ca3af; text-align: center; width: 100%;">No symptoms selected yet</p>';
            }
        }

        // ========== FORWARD CHAINING ALGORITHM ==========
        function runInference() {
            // Get selected facts
            const selectedFacts = [];
            allFacts.forEach(fact => {
                if (document.getElementById(fact.id).checked) {
                    selectedFacts.push(fact.id);
                }
            });

            if (selectedFacts.length === 0) {
                alert("ðŸš— Please select at least one symptom to begin diagnosis.");
                return;
            }

            // Clear and setup log
            const log = document.getElementById('inferenceLog');
            const resultsContainer = document.getElementById('resultsContainer');
            log.innerHTML = '';
            resultsContainer.innerHTML = '';

            // Start inference
            log.innerHTML += `
                <div class="log-entry" style="border-color: #3b82f6;">
                    <div class="log-step"><i class="fas fa-play"></i> Inference Started</div>
                    <p>Beginning forward chaining with ${selectedFacts.length} initial symptom(s)</p>
                </div>
            `;

            let allInferredFacts = [...selectedFacts];
            let iteration = 1;
            let anyRuleFired = true;
            const firedRules = [];

            // Initial facts display
            log.innerHTML += `
                <div class="log-entry">
                    <div class="log-step">Step ${++iteration}: Initial Facts</div>
                    <p>Detected symptoms: <span class="log-fact">${selectedFacts.map(f => allFacts.find(x => x.id === f).label).join(', ')}</span></p>
                </div>
            `;

            // Forward chaining loop
            while (anyRuleFired) {
                anyRuleFired = false;
                
                rules.forEach(rule => {
                    // Check if rule hasn't been fired and all conditions are met
                    if (!firedRules.includes(rule.id) && 
                        rule.conditions.every(cond => allInferredFacts.includes(cond))) {
                        
                        // Fire the rule
                        anyRuleFired = true;
                        firedRules.push(rule.id);
                        
                        // Add conclusion to new facts if not already present
                        if (!allInferredFacts.includes(rule.conclusion)) {
                            allInferredFacts.push(rule.conclusion);
                            
                            log.innerHTML += `
                                <div class="log-entry">
                                    <div class="log-step">Step ${++iteration}: Rule Fired <span class="log-rule">${rule.id}</span></div>
                                    <p>Applied: <strong>IF ${rule.conditions.join(' AND ')} THEN ${rule.conclusion}</strong></p>
                                    <p class="log-desc">${rule.description}</p>
                                    <p>New fact inferred: <span class="log-fact">${rule.conclusion}</span></p>
                                </div>
                            `;
                        }
                    }
                });
            }

            // Final state
            log.innerHTML += `
                <div class="log-entry" style="border-color: #10b981;">
                    <div class="log-step"><i class="fas fa-flag-checkered"></i> Inference Complete</div>
                    <p>Processed ${firedRules.length} rules, ${allInferredFacts.length} total facts inferred</p>
                    <p>Final facts: <span class="log-fact">${allInferredFacts.join(', ')}</span></p>
                </div>
            `;

            // Display conclusions with solutions
            displayConclusions(allInferredFacts);
        }

        // ========== DISPLAY CONCLUSIONS ==========
        function displayConclusions(facts) {
            const resultsContainer = document.getElementById('resultsContainer');
            const diagnosticFacts = facts.filter(f => 
                Object.keys(solutions).includes(f)
            );

            if (diagnosticFacts.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="diagnosis-card">
                        <div class="diagnosis-title"><i class="fas fa-search"></i> Diagnosis Complete</div>
                        <div class="diagnosis-result">No Specific Issues Found</div>
                        <div class="solution-card">
                            <div class="solution-title"><i class="fas fa-lightbulb"></i> Recommended Action</div>
                            <ul class="solution-steps">
                                <li><span class="step-number">1</span> Check basic maintenance items: fuel level, battery connections, fuses</li>
                                <li><span class="step-number">2</span> Consider professional diagnostic scan if symptoms persist</li>
                                <li><span class="step-number">3</span> Review vehicle maintenance schedule</li>
                            </ul>
                        </div>
                    </div>
                `;
                return;
            }

            let resultsHTML = `
                <div class="diagnosis-card">
                    <div class="diagnosis-title"><i class="fas fa-stethoscope"></i> DIAGNOSIS RESULTS</div>
                    <div class="diagnosis-result">${diagnosticFacts.length} Issue(s) Identified</div>
            `;

            diagnosticFacts.forEach(problem => {
                const solution = solutions[problem];
                resultsHTML += `
                    <div class="solution-card">
                        <div class="solution-title">
                            <i class="fas fa-wrench"></i> ${solution.title}
                            <span style="margin-left: auto; background: ${solution.severity === 'Critical' ? '#ef4444' : solution.severity === 'High' ? '#f59e0b' : '#10b981'}; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.9rem;">
                                ${solution.severity} Priority
                            </span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px; color: #6b7280;">
                            <span><i class="fas fa-clock"></i> ${solution.time}</span>
                            <span><i class="fas fa-dollar-sign"></i> ${solution.estimatedCost}</span>
                        </div>
                        <ul class="solution-steps">
                `;
                
                solution.steps.forEach((step, index) => {
                    resultsHTML += `
                        <li><span class="step-number">${index + 1}</span> ${step}</li>
                    `;
                });
                
                resultsHTML += `
                        </ul>
                    </div>
                `;
            });

            resultsHTML += `</div>`;
            resultsContainer.innerHTML = resultsHTML;
        }

        // ========== UTILITY FUNCTIONS ==========
        function resetFacts() {
            allFacts.forEach(fact => {
                document.getElementById(fact.id).checked = false;
            });
            document.getElementById('inferenceLog').innerHTML = `
                <div class="log-entry" style="border-color: #9ca3af;">
                    <div class="log-step"><i class="fas fa-info-circle"></i> System Ready</div>
                    <p>Select symptoms and click "Start Diagnosis" to begin the inference process.</p>
                </div>
            `;
            document.getElementById('resultsContainer').innerHTML = '';
            updateSelectedFacts();
        }

        function showExample() {
            resetFacts();
            // Set example: Engine won't start with no cranking
            document.getElementById('engine_no_start').checked = true;
            document.getElementById('no_cranking').checked = true;
            document.getElementById('check_engine_light').checked = true;
            updateSelectedFacts();
            
            // Auto-run inference after a delay
            setTimeout(() => {
                runInference();
            }, 500);
        }

        // ========== INITIALIZE ON LOAD ==========
        document.addEventListener('DOMContentLoaded', initializeUI);
    </script>
</body>
</html>
